<svg width="800" height="500" xmlns="http://www.w3.org/2000/svg">
  <!-- 背景 -->
  <rect width="800" height="500" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- 标题 -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">同步事件处理流程</text>
  
  <!-- 组件 -->
  <!-- 发布者 -->
  <rect x="100" y="100" width="150" height="60" fill="#4285f4" rx="10" ry="10" opacity="0.8"/>
  <text x="175" y="135" font-family="Arial" font-size="16" fill="white" text-anchor="middle">发布者</text>
  
  <!-- 事件总线 -->
  <rect x="325" y="100" width="150" height="60" fill="#ea4335" rx="10" ry="10" opacity="0.8"/>
  <text x="400" y="135" font-family="Arial" font-size="16" fill="white" text-anchor="middle">事件总线</text>
  
  <!-- 监听器注册表 -->
  <rect x="550" y="100" width="150" height="60" fill="#fbbc05" rx="10" ry="10" opacity="0.8"/>
  <text x="625" y="135" font-family="Arial" font-size="16" fill="white" text-anchor="middle">监听器注册表</text>
  
  <!-- 监听器1 -->
  <rect x="250" y="300" width="150" height="60" fill="#34a853" rx="10" ry="10" opacity="0.8"/>
  <text x="325" y="335" font-family="Arial" font-size="16" fill="white" text-anchor="middle">监听器 1</text>
  
  <!-- 监听器2 -->
  <rect x="450" y="300" width="150" height="60" fill="#34a853" rx="10" ry="10" opacity="0.8"/>
  <text x="525" y="335" font-family="Arial" font-size="16" fill="white" text-anchor="middle">监听器 2</text>
  
  <!-- 流程步骤 -->
  <!-- 步骤1：发布事件 -->
  <line x1="250" y1="130" x2="325" y2="130" stroke="#333" stroke-width="2"/>
  <polygon points="320,125 330,135 325,130" fill="#333"/>
  <circle cx="290" y="130" r="15" fill="#4285f4" opacity="0.8"/>
  <text x="290" y="135" font-family="Arial" font-size="12" fill="white" text-anchor="middle">1</text>
  <text x="290" y="110" font-family="Arial" font-size="12" text-anchor="middle">publish(event)</text>
  
  <!-- 步骤2：查找监听器 -->
  <line x1="475" y1="130" x2="550" y2="130" stroke="#333" stroke-width="2"/>
  <polygon points="545,125 555,135 550,130" fill="#333"/>
  <circle cx="510" y="130" r="15" fill="#ea4335" opacity="0.8"/>
  <text x="510" y="135" font-family="Arial" font-size="12" fill="white" text-anchor="middle">2</text>
  <text x="510" y="110" font-family="Arial" font-size="12" text-anchor="middle">查找监听器</text>
  
  <!-- 步骤3：返回监听器列表 -->
  <line x1="550" y1="160" x2="475" y2="160" stroke="#333" stroke-width="2"/>
  <polygon points="480,155 470,165 475,160" fill="#333"/>
  <circle cx="510" y="160" r="15" fill="#fbbc05" opacity="0.8"/>
  <text x="510" y="165" font-family="Arial" font-size="12" fill="white" text-anchor="middle">3</text>
  <text x="510" y="180" font-family="Arial" font-size="12" text-anchor="middle">返回监听器列表</text>
  
  <!-- 步骤4：调用监听器1 -->
  <line x1="400" y1="160" x2="400" y2="220" stroke="#333" stroke-width="2"/>
  <line x1="400" y1="220" x2="325" y2="300" stroke="#333" stroke-width="2"/>
  <polygon points="330,295 320,305 325,300" fill="#333"/>
  <circle cx="360" y="260" r="15" fill="#ea4335" opacity="0.8"/>
  <text x="360" y="265" font-family="Arial" font-size="12" fill="white" text-anchor="middle">4</text>
  <text x="360" y="240" font-family="Arial" font-size="12" text-anchor="middle">同步调用监听器1</text>
  
  <!-- 步骤5：监听器1处理完成 -->
  <line x1="325" y1="360" x2="325" y2="400" stroke="#333" stroke-width="2"/>
  <line x1="325" y1="400" x2="400" y2="400" stroke="#333" stroke-width="2"/>
  <circle cx="325" y="380" r="15" fill="#34a853" opacity="0.8"/>
  <text x="325" y="385" font-family="Arial" font-size="12" fill="white" text-anchor="middle">5</text>
  <text x="325" y="420" font-family="Arial" font-size="12" text-anchor="middle">处理完成</text>
  
  <!-- 步骤6：调用监听器2 -->
  <line x1="400" y1="220" x2="525" y2="300" stroke="#333" stroke-width="2"/>
  <polygon points="520,295 530,305 525,300" fill="#333"/>
  <circle cx="460" y="260" r="15" fill="#ea4335" opacity="0.8"/>
  <text x="460" y="265" font-family="Arial" font-size="12" fill="white" text-anchor="middle">6</text>
  <text x="460" y="240" font-family="Arial" font-size="12" text-anchor="middle">同步调用监听器2</text>
  
  <!-- 步骤7：监听器2处理完成 -->
  <line x1="525" y1="360" x2="525" y2="400" stroke="#333" stroke-width="2"/>
  <line x1="525" y1="400" x2="400" y2="400" stroke="#333" stroke-width="2"/>
  <circle cx="525" y="380" r="15" fill="#34a853" opacity="0.8"/>
  <text x="525" y="385" font-family="Arial" font-size="12" fill="white" text-anchor="middle">7</text>
  <text x="525" y="420" font-family="Arial" font-size="12" text-anchor="middle">处理完成</text>
  
  <!-- 步骤8：返回结果 -->
  <line x1="400" y1="400" x2="400" y2="450" stroke="#333" stroke-width="2"/>
  <line x1="400" y1="450" x2="175" y2="450" stroke="#333" stroke-width="2"/>
  <line x1="175" y1="450" x2="175" y2="160" stroke="#333" stroke-width="2"/>
  <polygon points="170,165 180,165 175,160" fill="#333"/>
  <circle cx="290" y="450" r="15" fill="#ea4335" opacity="0.8"/>
  <text x="290" y="455" font-family="Arial" font-size="12" fill="white" text-anchor="middle">8</text>
  <text x="290" y="470" font-family="Arial" font-size="12" text-anchor="middle">所有监听器处理完成后返回</text>
  
  <!-- 阻塞标记 -->
  <rect x="50" y="200" width="100" height="200" fill="#4285f4" opacity="0.1" rx="5" ry="5"/>
  <text x="100" y="300" font-family="Arial" font-size="14" text-anchor="middle" transform="rotate(-90 100,300)">发布者线程被阻塞</text>
  
  <!-- 底部说明 -->
  <text x="400" y="490" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">同步事件处理中，发布者线程会等待所有监听器处理完成后才继续执行</text>
</svg>